<!DOCTYPE html>
<html>

<head>
    <style>
        #box {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            width: 300px;
            height: 300px;
            background-color: bisque;
        }

        .cell {
            border: 1px solid #fff;
            vertical-align: middle;
            line-height: 100px;
            font-size: 50px;
            text-align: center;
            cursor: pointer;
        }
    </style>
</head>

<body>

    <div id="box"></div>
    <script>
        let data = [
            0, 0, 2,
            0, 1, 0,
            0, 0, 0];
        let color = 1;
        var a = 0;

        show(data)
        // Computedmove()
        function show(data) {
            let root_node = document.getElementById('box');
            root_node.innerHTML = '';
            if (check(data, color)) {
                alert(color == 1 ? '⭕ win' : '❌ win')
            }
            data.forEach((v, i) => {
                let node = document.createElement('div');
                node.classList.add('cell')
                node.innerText = v == 1 ? '⭕' : v == 2 ? '❌' : '';

                node.addEventListener('click', () => Usermove(i))
                root_node.appendChild(node)
            })

        }
        function Usermove(i) {
            if (data[i] == 0) {
                data[i] = color;

                color = 3 - color;

                show(data);

                Computedmove();
            }
        }
        function Computedmove() {
            let c = bestchoice(data, color).point

            if (Array.isArray(c)) {
                c = c[0] * c[1]
            }
            if (data[c] == 0) {
                data[c] = color;
                show(data)

                color = 3 - color;
            }
        }

        function check(data, color) {
            // ---
            for (let i = 0; i < 3; i++) {
                let win = true;
                for (let j = 0; j < 3; j++) {
                    if (data[3 * i + j] !== color) {
                        win = false;
                        break;
                    }
                }
                if (win) return true;
            }
            // |||
            for (let i = 0; i < 3; i++) {
                let win = true;

                for (let j = 0; j < 3; j++) {
                    if (data[i + 3 * j] !== color) {
                        win = false;
                        break;
                    }
                }
                if (win) return true;

            }
            {
                let win = true;
                for (let i = 0; i < 3; i++) {
                    if (data[i * 4] !== color) {
                        win = false;
                    }
                }
                if (win) return true;
            }
            {
                let win = true;
                for (let i = 0; i < 3; i++) {

                    if (data[i * 2 + 2] !== color) {
                        win = false;
                    }
                }
                if (win) return true;
            }
        }

        function clone(data) {
            return JSON.parse(JSON.stringify(data));
        }

        function willWin(data, color) {

            for (let i = 0; i < 9; i++) {
                if (data[i]) continue;
                let tmp = clone(data);
                tmp[i] = color;
                if (check(tmp, color)) {
                    return i;
                }
            }
            return null;
        }

        function bestchoice(data, cc) {

            let point = willWin(data, cc);
            if (point !== null) {
                return {
                    point: point,
                    res: 1
                }
            }
            let res = -1;

            let lost = willWin(data, 3 - cc);

            if (lost !== null) {
                point = lost,
                res = -1;
            }
            
            for (let i = 0; i < 9; i++) {
                if (data[i] !== 0) continue;

                let tmp = clone(data);
                tmp[i] = cc;
                let r = bestchoice(tmp, 3 - cc);
                if (-r.res > res) {
                    res = -r.res;
                    point = i;
                }
                if (res == 1) {
                    break;
                }
            }

            return {
                point: point,
                res: point != null ? res : 0
            }
        }



    </script>
</body>

</html>